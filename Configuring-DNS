# Commands

# Dependencies: 
   sudo apt install -y bind9 bind9utils bind9-doc dnsutils
   
# Path to Zone file - /etc/bind/db.local
   
   cd /etc/bind - contains all bind configuration files
   
         Step 2) Configure Bind 9 (DNS Server)
            Once all the packages have been installed, we will move into the configuration part. All configuration files for BIND are located in folder ‘/etc/bind’.

            One of the important configuration file for bind is “/etc/bind/named.conf.options“, from this file we can set the followings parameters:

            Allow Query to your dns from your private network (As the name suggests only the systems from your private network can query dns sever for name to ip translation and vice-versa)
            Allow recursive query
            Specify the DNS port ( 53)
            Frwarders (DNS query will be forwarded to the forwarders when your local DNS server is unable to resolve query)

   fileS includes Global options plus zone and include statements:
      All statements start with a left curly bracket "{" a right curly bracket "}" and a semicolon ";"
      
      sudo less /etc/bind/named.conf
      
       // This is the primary configuration file for the BIND DNS server named.
      //
      // Please read /usr/share/doc/bind9/README.Debian for information on the
      // structure of BIND configuration files in Debian, *BEFORE* you customize
      // this configuration file.
      //
      // If you are just adding zones, please do that in /etc/bind/named.conf.local

      include "/etc/bind/named.conf.options";
      
                options {
                directory "/var/cache/bind";

                // If there is a firewall between you and nameservers you want
                // to talk to, you may need to fix the firewall to allow multiple
                // ports to talk.  See http://www.kb.cert.org/vuls/id/800113

                // If your ISP provided one or more IP addresses for stable 
                // nameservers, you probably want to use them as forwarders.  
                // Uncomment the following block, and insert the addresses replacing 
                // the all-0's placeholder.

                // forwarders {
                // 	0.0.0.0;
                // };

                //========================================================================
                // If BIND logs error messages about the root key being expired,
                // you will need to update your keys.  See https://www.isc.org/bind-keys
                //========================================================================
                dnssec-validation auto;

                listen-on-v6 { any; };
              };

     
      
      
      include "/etc/bind/named.conf.local";
            //
            // Do any local configuration here
            //

            // Consider adding the 1918 zones here, if they are not used in your
            // organization
            //include "/etc/bind/zones.rfc1918";


                
      include "/etc/bind/named.conf.default-zones";
            
              // prime the server with knowledge of the root servers
                  zone "." {
                    type hint;
                    file "/usr/share/dns/root.hints";
                  };

                  // be authoritative for the localhost forward and reverse zones, and for
                  // broadcast zones as per RFC 1912

                  zone "localhost" {
                    type master;
                    file "/etc/bind/db.local";
                  };

                  zone "127.in-addr.arpa" {
                    type master;
                    file "/etc/bind/db.127";
                  };

                  zone "0.in-addr.arpa" {
                    type master;
                    file "/etc/bind/db.0";
                  };

                  zone "255.in-addr.arpa" {
                    type master;
                    file "/etc/bind/db.255";
                  };



      Configuration Schema:
--------------------

The Debian BIND package ships with a config that will work for the majority 
of leaf servers with no user input required.

The named configuration file named.conf is located in /etc/bind, so that all 
static configuration files relating to bind are in one place.  If you really 
don't want named.conf in /etc/bind, then the best way to handle it is probably
to replace /etc/bind/named.conf with a symlink to the location you want to use.
You could also use an option to named in the init.d script, but that only works
for named, not for things like ndc.

Zone data files for the root servers, and the forward and reverse localhost
zones are also provided in /etc/bind.

The working directory for named is now /var/cache/bind.  Thus, any transient
files generated by named, such as database files for zones the daemon is
secondary for, will be written to the /var filesystem, where they belong.

To make this work, the named.conf provided uses explicitly fully-qualified
pathnames to reference the files in /etc/bind. 

Unlike previous BIND packages for Debian, the named.conf and provided db.*
files are tagged as conffiles.  Thus, if you just want a "caching mostly"
server configuration for a server that does not need to be authoritative for
anything else, you can run the provided configuration as-is.  If you want to
hack on named.conf, or even the init.d fragment, you can feel free to.  Future
package upgrades will treat your configuration changes sanely, as all Debian
packages should.

While you are free to craft whatever structure you wish for servers which need
to be authoritative for additional zones, what we suggest is that you put the
db files for any zones you are master for in /etc/bind (perhaps even in a
subdirectory structure depending on complexity), using full pathnames in the
named.conf file.  Any zones you are secondary for should be configured in
named.conf with simple filenames (relative to /var/cache/bind), so the data
files will be stored in BIND's working directory (defaults to /var/cache/bind).
Zones subject to automatic updates (such as via DHCP and/or nsupdate) should be
stored in /var/lib/bind, and specified with full pathnames.


Apparmor Profile
----------------
If your system uses apparmor, please note that the shipped enforcing profile
works with the default installation, and changes in your configuration may
require changes to the installed apparmor profile. Please see
https://wiki.ubuntu.com/DebuggingApparmor before filing a bug against this
software.
        

  
  
